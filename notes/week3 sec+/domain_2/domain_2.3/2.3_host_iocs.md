# Session 3 — Host Indicators of Compromise (Host IOCs)

---

### What to look for
- **CPU or memory spikes** → sudden high usage by unknown processes often points to malware running or cryptomining.  
- **Odd or unexpected services** → new background services that weren’t installed by IT or don’t match any baseline can signal persistence.  
- **Persistence mechanisms** → malware modifying registry Run keys, adding scheduled tasks, or installing hidden services to restart automatically.  
- **Fileless malware** → malicious code that never touches the disk. It lives in memory and abuses legitimate tools (like PowerShell or WMI) to inject its code.  
- **Weird process trees** → legitimate processes spawning unusual child processes (`explorer.exe` → `cmd.exe` → `powershell.exe`) are strong red flags.

---

### Key concept: Fileless malware
Fileless malware is **malicious code that runs entirely in memory**, not from a file stored on disk.  
It often hijacks trusted system processes such as PowerShell, WMI (`wmic.exe`), or Microsoft Office macros to execute its payload, making it harder for traditional antivirus to detect.

---

### Scenario
Windows Event Log shows `wmic.exe` spawning `powershell.exe`.  

- This **could be legitimate** if an admin script or management tool triggered it for automation.  
- But if it’s **unexpected** on a user workstation or coming from an unapproved script, it might be an **attack behavior**.  
- Context matters — check timestamps, parent processes, logged-in users, and recent commands.

---

### Applied — how to confirm
- **Sysmon logs:**  
  - Check **Event ID 1 (Process Creation)** to see the parent and child process chain.  
  - Review command-line arguments — encoded or obfuscated PowerShell commands are suspicious.  
  - Look for additional Sysmon events like network connections (Event ID 3) from that process.  

- **EDR (Endpoint Detection & Response):**  
  - Correlate with alerts for script-based attacks, privilege escalation, or persistence.  
  - Verify if similar behavior occurred on multiple hosts (lateral movement pattern).  

- **Registry / Task Scheduler check:**  
  - Inspect for new persistence entries created around the same time.  


<!-- 1. Explain each host IOC.  
2. Describe how fileless malware hides itself.  
3. Talk through the `wmic.exe` → `powershell.exe` scenario and what i'd check next.  
4. Outline how Sysmon or EDR would help confirm the activity. -->